<!--
Copyright 2021 Carnegie Mellon University. All Rights Reserved.
Released under a MIT (SEI)-style license. See LICENSE.md in the project root for license information.
-->

<div *ngIf="mapInitialzed == true">
  <div>
    <svg viewBox="0 8 100 100">
      <!--
        How to link to files that have been uploaded to player?
        Didn't work:
          blob://<file>
          file:///<path>
          the download link generated in Player
        Solution: use DomSanitizer.bypassSecurityTrustUrl to create an object url from the blob returned by playerapi/files/download/{id}
        So call the endpoint to download the file, get the blob it returns, and turn that into a url to get displayed by the img element
      -->
      <image [attr.href]="imageUrl" width="100" height="100" (click)="append($event)"/>
      <g *ngFor="let m of machines" >
        <circle class="clickpoint" [attr.cx]="m.xPosition" [attr.cy]="m.yPosition" [attr.r]="m.radius" (click)="edit(m)" fill-opacity="1.0"> </circle>
        <text class="clickpoint" [attr.x]="m.xPosition" [attr.y]="m.yPosition" [attr.font-size]="calcFontSize(m.radius)" fill="white" text-anchor="middle" (click)="edit(m)">{{m.label}}</text>
      </g>
    </svg>
  </div>
  
  <ng-template #addPointDialog>
    <app-add-point
      (machineEmitter)="receiveMachine($event)"
      xPos={{xActual}}
      yPos={{yActual}}
      rad={{selectedRad}}
      url={{selectedURL}}
      id={{idToSend}}
      label={{selectedLabel}}
    >
    </app-add-point>
  </ng-template>
</div>